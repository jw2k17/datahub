"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[52660],{15680:(e,t,a)=>{a.d(t,{xA:()=>c,yg:()=>g});var n=a(96540);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(a),m=o,g=p["".concat(s,".").concat(m)]||p[m]||u[m]||r;return a?n.createElement(g,i(i({ref:t},c),{},{components:a})):n.createElement(g,i({ref:t},c))}));function g(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,i[1]=l;for(var d=2;d<r;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},45789:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>g,frontMatter:()=>l,metadata:()=>d,toc:()=>p});a(96540);var n=a(15680);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})),e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}const l={title:"Local Development",sidebar_label:"Local Development",slug:"/developers",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/developers.md"},s="DataHub Developer's Guide",d={unversionedId:"docs/developers",id:"version-0.14.1/docs/developers",title:"Local Development",description:"Requirements",source:"@site/versioned_docs/version-0.14.1/docs/developers.md",sourceDirName:"docs",slug:"/developers",permalink:"/docs/0.14.1/developers",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/developers.md",tags:[],version:"0.14.1",frontMatter:{title:"Local Development",sidebar_label:"Local Development",slug:"/developers",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/developers.md"},sidebar:"overviewSidebar",previous:{title:"DataHubConnection",permalink:"/docs/0.14.1/generated/metamodel/entities/datahubconnection"},next:{title:"Using Docker Images During Development",permalink:"/docs/0.14.1/docker/development"}},c={},p=[{value:"Requirements",id:"requirements",level:2},{value:"Building the Project",id:"building-the-project",level:2},{value:"Deploying Local Versions",id:"deploying-local-versions",level:2},{value:"IDE Support",id:"ide-support",level:2},{value:"Windows Compatibility",id:"windows-compatibility",level:2},{value:"Common Build Issues",id:"common-build-issues",level:2},{value:"Getting <code>Unsupported class file major version 57</code>",id:"getting-unsupported-class-file-major-version-57",level:4},{value:"Getting <code>cannot find symbol</code> error for <code>javax.annotation.Generated</code>",id:"getting-cannot-find-symbol-error-for-javaxannotationgenerated",level:4},{value:"<code>:metadata-models:generateDataTemplate</code> task fails with <code>java.nio.file.InvalidPathException: Illegal char &lt;:&gt; at index XX</code> or <code>Caused by: java.lang.IllegalArgumentException: &#39;other&#39; has different root</code> error",id:"metadata-modelsgeneratedatatemplate-task-fails-with-javaniofileinvalidpathexception-illegal-char--at-index-xx-or-caused-by-javalangillegalargumentexception-other-has-different-root-error",level:4},{value:"Various errors related to <code>generateDataTemplate</code> or other <code>generate</code> tasks",id:"various-errors-related-to-generatedatatemplate-or-other-generate-tasks",level:4},{value:"<code>Execution failed for task &#39;:metadata-service:restli-servlet-impl:checkRestModel&#39;</code>",id:"execution-failed-for-task-metadata-servicerestli-servlet-implcheckrestmodel",level:4},{value:"<code>java.io.IOException: No space left on device</code>",id:"javaioioexception-no-space-left-on-device",level:4},{value:"<code>Build failed</code> for task <code>./gradlew :datahub-frontend:dist -x yarnTest -x yarnLint</code>",id:"build-failed-for-task-gradlew-datahub-frontenddist--x-yarntest--x-yarnlint",level:4},{value:"<code>:buildSrc:compileJava</code> task fails with <code>package com.linkedin.metadata.models.registry.config does not exist</code> and <code>cannot find symbol</code> error for <code>Entity</code>",id:"buildsrccompilejava-task-fails-with-package-comlinkedinmetadatamodelsregistryconfig-does-not-exist-and-cannot-find-symbol-error-for-entity",level:4}],u={toc:p},m="wrapper";function g(e){var{components:t}=e,a=i(e,["components"]);return(0,n.yg)(m,r(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){o(e,t,a[t])}))}return e}({},u,a),{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"datahub-developers-guide"},"DataHub Developer's Guide"),(0,n.yg)("h2",{id:"requirements"},"Requirements"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://openjdk.org/projects/jdk/17/"},"Java 17 JDK")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://www.python.org/downloads/release/python-3100/"},"Python 3.10")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://www.docker.com/"},"Docker")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://docs.docker.com/compose/"},"Docker Compose >=2.20")),(0,n.yg)("li",{parentName:"ul"},"Docker engine with at least 8GB of memory to run tests.")),(0,n.yg)("p",null,"On macOS, these can be installed using ",(0,n.yg)("a",{parentName:"p",href:"https://brew.sh/"},"Homebrew"),"."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"# Install Java\nbrew install openjdk@17\n\n# Install Python\nbrew install python@3.10  # you may need to add this to your PATH\n# alternatively, you can use pyenv to manage your python versions\n\n# Install docker and docker compose\nbrew install --cask docker\n")),(0,n.yg)("h2",{id:"building-the-project"},"Building the Project"),(0,n.yg)("p",null,"Fork and clone the repository if haven't done so already"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/{username}/datahub.git\n")),(0,n.yg)("p",null,"Change into the repository's root directory"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"cd datahub\n")),(0,n.yg)("p",null,"Use ",(0,n.yg)("a",{parentName:"p",href:"https://docs.gradle.org/current/userguide/gradle_wrapper.html"},"gradle wrapper")," to build the project"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"./gradlew build\n")),(0,n.yg)("p",null,"Note that the above will also run tests and a number of validations which makes the process considerably slower."),(0,n.yg)("p",null,"We suggest partially compiling DataHub according to your needs:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},"Build Datahub's backend GMS (Generalized metadata service):"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre"},"./gradlew :metadata-service:war:build\n"))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},"Build Datahub's frontend:"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre"},"./gradlew :datahub-frontend:dist -x yarnTest -x yarnLint\n"))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},"Build DataHub's command line tool:"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre"},"./gradlew :metadata-ingestion:installDev\n"))),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},"Build DataHub's documentation:"),(0,n.yg)("pre",{parentName:"li"},(0,n.yg)("code",{parentName:"pre"},"./gradlew :docs-website:yarnLintFix :docs-website:build -x :metadata-ingestion:runPreFlightScript\n# To preview the documentation\n./gradlew :docs-website:serve\n")))),(0,n.yg)("h2",{id:"deploying-local-versions"},"Deploying Local Versions"),(0,n.yg)("p",null,"Run just once to have the local ",(0,n.yg)("inlineCode",{parentName:"p"},"datahub")," cli tool installed in your $PATH"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"cd smoke-test/\npython3 -m venv venv\nsource venv/bin/activate\npip install --upgrade pip wheel setuptools\npip install -r requirements.txt\ncd ../\n")),(0,n.yg)("p",null,"Once you have compiled & packaged the project or appropriate module you can deploy the entire system via docker-compose by running:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"./gradlew quickstart\n")),(0,n.yg)("p",null,"Replace whatever container you want in the existing deployment.\nI.e, replacing datahub's backend (GMS):"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"(cd docker && COMPOSE_DOCKER_CLI_BUILD=1 DOCKER_BUILDKIT=1 docker compose -p datahub -f docker-compose-without-neo4j.yml -f docker-compose-without-neo4j.override.yml -f docker-compose.dev.yml up -d --no-deps --force-recreate --build datahub-gms)\n")),(0,n.yg)("p",null,"Running the local version of the frontend"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"(cd docker && COMPOSE_DOCKER_CLI_BUILD=1 DOCKER_BUILDKIT=1 docker compose -p datahub -f docker-compose-without-neo4j.yml -f docker-compose-without-neo4j.override.yml -f docker-compose.dev.yml up -d --no-deps --force-recreate --build datahub-frontend-react)\n")),(0,n.yg)("h2",{id:"ide-support"},"IDE Support"),(0,n.yg)("p",null,"The recommended IDE for DataHub development is ",(0,n.yg)("a",{parentName:"p",href:"https://www.jetbrains.com/idea/"},"IntelliJ IDEA"),".\nYou can run the following command to generate or update the IntelliJ project file."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"./gradlew idea\n")),(0,n.yg)("p",null,"Open ",(0,n.yg)("inlineCode",{parentName:"p"},"datahub.ipr")," in IntelliJ to start developing!"),(0,n.yg)("p",null,"For consistency please import and auto format the code using ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/gradle/idea/LinkedIn%20Style.xml"},"LinkedIn IntelliJ Java style"),"."),(0,n.yg)("h2",{id:"windows-compatibility"},"Windows Compatibility"),(0,n.yg)("p",null,"For optimal performance and compatibility, we strongly recommend building on a Mac or Linux system.\nPlease note that we do not actively support Windows in a non-virtualized environment."),(0,n.yg)("p",null,"If you must use Windows, one workaround is to build within a virtualized environment, such as a VM(Virtual Machine) or ",(0,n.yg)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/windows/wsl"},"WSL(Windows Subsystem for Linux)"),".\nThis approach can help ensure that your build environment remains isolated and stable, and that your code is compiled correctly."),(0,n.yg)("h2",{id:"common-build-issues"},"Common Build Issues"),(0,n.yg)("h4",{id:"getting-unsupported-class-file-major-version-57"},"Getting ",(0,n.yg)("inlineCode",{parentName:"h4"},"Unsupported class file major version 57")),(0,n.yg)("p",null,"You're probably using a Java version that's too new for gradle. Run the following command to check your Java version"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"java --version\n")),(0,n.yg)("p",null,"While it may be possible to build and run DataHub using newer versions of Java, we currently only support ",(0,n.yg)("a",{parentName:"p",href:"https://openjdk.org/projects/jdk/17/"},"Java 17")," (aka Java 17)."),(0,n.yg)("h4",{id:"getting-cannot-find-symbol-error-for-javaxannotationgenerated"},"Getting ",(0,n.yg)("inlineCode",{parentName:"h4"},"cannot find symbol")," error for ",(0,n.yg)("inlineCode",{parentName:"h4"},"javax.annotation.Generated")),(0,n.yg)("p",null,"Similar to the previous issue, please use Java 17 to build the project.\nYou can install multiple version of Java on a single machine and switch between them using the ",(0,n.yg)("inlineCode",{parentName:"p"},"JAVA_HOME")," environment variable. See ",(0,n.yg)("a",{parentName:"p",href:"https://docs.oracle.com/cd/E21454_01/html/821-2531/inst_jdk_javahome_t.html"},"this document")," for more details."),(0,n.yg)("h4",{id:"metadata-modelsgeneratedatatemplate-task-fails-with-javaniofileinvalidpathexception-illegal-char--at-index-xx-or-caused-by-javalangillegalargumentexception-other-has-different-root-error"},(0,n.yg)("inlineCode",{parentName:"h4"},":metadata-models:generateDataTemplate")," task fails with ",(0,n.yg)("inlineCode",{parentName:"h4"},"java.nio.file.InvalidPathException: Illegal char <:> at index XX")," or ",(0,n.yg)("inlineCode",{parentName:"h4"},"Caused by: java.lang.IllegalArgumentException: 'other' has different root")," error"),(0,n.yg)("p",null,"This is a ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/linkedin/rest.li/issues/287"},"known issue")," when building the project on Windows due a bug in the Pegasus plugin. Please refer to ",(0,n.yg)("a",{parentName:"p",href:"/docs/0.14.1/developers#windows-compatibility"},"Windows Compatibility"),"."),(0,n.yg)("h4",{id:"various-errors-related-to-generatedatatemplate-or-other-generate-tasks"},"Various errors related to ",(0,n.yg)("inlineCode",{parentName:"h4"},"generateDataTemplate")," or other ",(0,n.yg)("inlineCode",{parentName:"h4"},"generate")," tasks"),(0,n.yg)("p",null,"As we generate quite a few files from the models, it is possible that old generated files may conflict with new model changes. When this happens, a simple ",(0,n.yg)("inlineCode",{parentName:"p"},"./gradlew clean")," should reosolve the issue."),(0,n.yg)("h4",{id:"execution-failed-for-task-metadata-servicerestli-servlet-implcheckrestmodel"},(0,n.yg)("inlineCode",{parentName:"h4"},"Execution failed for task ':metadata-service:restli-servlet-impl:checkRestModel'")),(0,n.yg)("p",null,"This generally means that an ",(0,n.yg)("a",{parentName:"p",href:"https://linkedin.github.io/rest.li/modeling/compatibility_check"},"incompatible change")," was introduced to the rest.li API in GMS. You'll need to rebuild the snapshots/IDL by running the following command once"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"./gradlew :metadata-service:restli-servlet-impl:build -Prest.model.compatibility=ignore\n")),(0,n.yg)("h4",{id:"javaioioexception-no-space-left-on-device"},(0,n.yg)("inlineCode",{parentName:"h4"},"java.io.IOException: No space left on device")),(0,n.yg)("p",null,"This means you're running out of space on your disk to build. Please free up some space or try a different disk."),(0,n.yg)("h4",{id:"build-failed-for-task-gradlew-datahub-frontenddist--x-yarntest--x-yarnlint"},(0,n.yg)("inlineCode",{parentName:"h4"},"Build failed")," for task ",(0,n.yg)("inlineCode",{parentName:"h4"},"./gradlew :datahub-frontend:dist -x yarnTest -x yarnLint")),(0,n.yg)("p",null,"This could mean that you need to update your ",(0,n.yg)("a",{parentName:"p",href:"https://yarnpkg.com/getting-started/install"},"Yarn")," version"),(0,n.yg)("h4",{id:"buildsrccompilejava-task-fails-with-package-comlinkedinmetadatamodelsregistryconfig-does-not-exist-and-cannot-find-symbol-error-for-entity"},(0,n.yg)("inlineCode",{parentName:"h4"},":buildSrc:compileJava")," task fails with ",(0,n.yg)("inlineCode",{parentName:"h4"},"package com.linkedin.metadata.models.registry.config does not exist")," and ",(0,n.yg)("inlineCode",{parentName:"h4"},"cannot find symbol")," error for ",(0,n.yg)("inlineCode",{parentName:"h4"},"Entity")),(0,n.yg)("p",null,"There are currently two symbolic links within the ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/tree/master/buildSrc"},"buildSrc")," directory for the ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/buildSrc/src/main/java/com/linkedin/metadata/aspect/plugins/config"},"com.linkedin.metadata.aspect.plugins.config")," and ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/buildSrc/src/main/java/com/linkedin/metadata/models/registry/config"},"com.linkedin.metadata.models.registry.config")," packages, which points to the corresponding packages in the ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/tree/master/entity-registry"},"entity-registry")," subproject."),(0,n.yg)("p",null,"When the repository is checked out using Windows 10/11 - even if WSL is later used for building using the mounted Windows filesystem in ",(0,n.yg)("inlineCode",{parentName:"p"},"/mnt/")," - the symbolic links might have not been created correctly, instead the symbolic links were checked out as plain files. Although it is technically possible to use the mounted Windows filesystem in ",(0,n.yg)("inlineCode",{parentName:"p"},"/mnt/")," for building in WSL, it is ",(0,n.yg)("strong",{parentName:"p"},"strongly recommended")," to checkout the repository within the Linux filesystem (e.g., in ",(0,n.yg)("inlineCode",{parentName:"p"},"/home/"),") and building it from there, because accessing the Windows filesystem from Linux is relatively slow compared to the Linux filesystem and slows down the whole building process."),(0,n.yg)("p",null,"To be able to create symbolic links in Windows 10/11 the ",(0,n.yg)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development"},"Developer Mode")," has to be enabled first. Then the following commands can be used to enable ",(0,n.yg)("a",{parentName:"p",href:"https://git-scm.com/docs/git-config#Documentation/git-config.txt-coresymlinks"},"symbolic links in Git")," and recreating the symbolic links:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"# enable core.symlinks config\ngit config --global core.symlinks true\n\n# check the current core.sysmlinks config and scope\ngit config --show-scope --show-origin core.symlinks\n\n# in case the core.sysmlinks config is still set locally to false, remove the local config\ngit config --unset core.symlinks\n\n# reset the current branch to recreate the missing symbolic links (alternatively it is also possibly to switch branches away and back)\ngit reset --hard\n")),(0,n.yg)("p",null,"See also ",(0,n.yg)("a",{parentName:"p",href:"https://stackoverflow.com/questions/5917249/git-symbolic-links-in-windows/59761201#59761201"},"here")," for more information on how to enable symbolic links on Windows 10/11 and Git."))}g.isMDXComponent=!0}}]);