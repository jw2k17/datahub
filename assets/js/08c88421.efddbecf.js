"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[45049],{86472:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>u,contentTitle:()=>d,default:()=>y,frontMatter:()=>g,metadata:()=>p,toc:()=>c});t(96540);var n=t(15680),r=t(53720),s=t(5400);function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){return a=null!=a?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):function(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})),e}function l(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}const g={title:"Tags",slug:"/api/tutorials/tags",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/api/tutorials/tags.md"},d="Tags",p={unversionedId:"docs/api/tutorials/tags",id:"docs/api/tutorials/tags",title:"Tags",description:"Why Would You Use Tags on Datasets?",source:"@site/genDocs/docs/api/tutorials/tags.md",sourceDirName:"docs/api/tutorials",slug:"/api/tutorials/tags",permalink:"/docs/api/tutorials/tags",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/api/tutorials/tags.md",tags:[],version:"current",frontMatter:{title:"Tags",slug:"/api/tutorials/tags",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/api/tutorials/tags.md"},sidebar:"overviewSidebar",previous:{title:"Structured Properties",permalink:"/docs/api/tutorials/structured-properties"},next:{title:"Terms",permalink:"/docs/api/tutorials/terms"}},u={},c=[{value:"Why Would You Use Tags on Datasets?",id:"why-would-you-use-tags-on-datasets",level:2},{value:"Goal Of This Guide",id:"goal-of-this-guide",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Create Tags",id:"create-tags",level:2},{value:"Expected Outcome of Creating Tags",id:"expected-outcome-of-creating-tags",level:3},{value:"Read Tags",id:"read-tags",level:2},{value:"Add Tags",id:"add-tags",level:2},{value:"Add Tags to a dataset",id:"add-tags-to-a-dataset",level:3},{value:"Add Tags to a Column of a dataset",id:"add-tags-to-a-column-of-a-dataset",level:3},{value:"Expected Outcome of Adding Tags",id:"expected-outcome-of-adding-tags",level:3},{value:"Remove Tags",id:"remove-tags",level:2},{value:"Expected Outcome of Removing Tags",id:"expected-outcome-of-removing-tags",level:3}],m={toc:c},h="wrapper";function y(e){var{components:a}=e,t=l(e,["components"]);return(0,n.yg)(h,i(function(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(a){o(e,a,t[a])}))}return e}({},m,t),{components:a,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"tags"},"Tags"),(0,n.yg)("h2",{id:"why-would-you-use-tags-on-datasets"},"Why Would You Use Tags on Datasets?"),(0,n.yg)("p",null,"Tags are informal, loosely controlled labels that help in search & discovery. They can be added to datasets, dataset schemas, or containers, for an easy way to label or categorize entities \u2013 without having to associate them to a broader business glossary or vocabulary.\nFor more information about tags, refer to ",(0,n.yg)("a",{parentName:"p",href:"/docs/tags"},"About DataHub Tags"),"."),(0,n.yg)("h3",{id:"goal-of-this-guide"},"Goal Of This Guide"),(0,n.yg)("p",null,"This guide will show you how to"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Create: create a tag."),(0,n.yg)("li",{parentName:"ul"},"Read : read tags attached to a dataset."),(0,n.yg)("li",{parentName:"ul"},"Add: add a tag to a column of a dataset or a dataset itself."),(0,n.yg)("li",{parentName:"ul"},"Remove: remove a tag from a dataset.")),(0,n.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.yg)("p",null,"For this tutorial, you need to deploy DataHub Quickstart and ingest sample data.\nFor detailed information, please refer to ",(0,n.yg)("a",{parentName:"p",href:"/docs/quickstart"},"Datahub Quickstart Guide"),"."),(0,n.yg)("admonition",{type:"note"},(0,n.yg)("p",{parentName:"admonition"},"Before modifying tags, you need to ensure the target dataset is already present in your DataHub instance.\nIf you attempt to manipulate entities that do not exist, your operation will fail.\nIn this guide, we will be using data from sample ingestion.")),(0,n.yg)("p",null,"For more information on how to set up for GraphQL, please refer to ",(0,n.yg)("a",{parentName:"p",href:"/docs/api/graphql/how-to-set-up-graphql"},"How To Set Up GraphQL"),"."),(0,n.yg)("h2",{id:"create-tags"},"Create Tags"),(0,n.yg)("p",null,"The following code creates a tag ",(0,n.yg)("inlineCode",{parentName:"p"},"Deprecated"),"."),(0,n.yg)(r.A,{mdxType:"Tabs"},(0,n.yg)(s.A,{value:"graphql",label:"GraphQL",default:!0,mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'mutation createTag {\n    createTag(input:\n    {\n      name: "Deprecated",\n      id: "deprecated",\n      description: "Having this tag means this column or table is deprecated."\n    })\n}\n')),(0,n.yg)("p",null,"If you see the following response, the operation was successful:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'{\n  "data": {\n    "createTag": "urn:li:tag:deprecated"\n  },\n  "extensions": {}\n}\n'))),(0,n.yg)(s.A,{value:"curl",label:"Curl",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'http://localhost:8080/api/graphql\' \\\n--header \'Authorization: Bearer <my-access-token>\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{ "query": "mutation createTag { createTag(input: { name: \\"Deprecated\\", id: \\"deprecated\\",description: \\"Having this tag means this column or table is deprecated.\\" }) }", "variables":{}}\'\n')),(0,n.yg)("p",null,"Expected Response:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'{ "data": { "createTag": "urn:li:tag:deprecated" }, "extensions": {} }\n'))),(0,n.yg)(s.A,{value:"java",label:"Java",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-java"},'# Inlined from /metadata-integration/java/examples/src/main/java/io/datahubproject/examples/TagCreate.java\npackage io.datahubproject.examples;\n\nimport com.linkedin.tag.TagProperties;\nimport datahub.client.MetadataWriteResponse;\nimport datahub.client.rest.RestEmitter;\nimport datahub.event.MetadataChangeProposalWrapper;\nimport java.io.IOException;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.Future;\n\npublic class TagCreate {\n\n  private TagCreate() {}\n\n  public static void main(String[] args)\n      throws IOException, ExecutionException, InterruptedException {\n    TagProperties tagProperties =\n        new TagProperties()\n            .setName("Deprecated")\n            .setDescription("Having this tag means this column or table is deprecated.");\n\n    MetadataChangeProposalWrapper mcpw =\n        MetadataChangeProposalWrapper.builder()\n            .entityType("tag")\n            .entityUrn("urn:li:tag:deprecated")\n            .upsert()\n            .aspect(tagProperties)\n            .build();\n\n    String token = "";\n    RestEmitter emitter = RestEmitter.create(b -> b.server("http://localhost:8080").token(token));\n    Future<MetadataWriteResponse> response = emitter.emit(mcpw, null);\n    System.out.println(response.get().getResponseContent());\n  }\n}\n\n'))),(0,n.yg)(s.A,{value:"python",label:"Python",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'# Inlined from /metadata-ingestion/examples/library/create_tag.py\nimport logging\n\nfrom datahub.emitter.mce_builder import make_tag_urn\nfrom datahub.emitter.mcp import MetadataChangeProposalWrapper\nfrom datahub.emitter.rest_emitter import DatahubRestEmitter\n\n# Imports for metadata model classes\nfrom datahub.metadata.schema_classes import TagPropertiesClass\n\nlog = logging.getLogger(__name__)\nlogging.basicConfig(level=logging.INFO)\n\ntag_urn = make_tag_urn("deprecated")\ntag_properties_aspect = TagPropertiesClass(\n    name="Deprecated",\n    description="Having this tag means this column or table is deprecated.",\n)\n\nevent: MetadataChangeProposalWrapper = MetadataChangeProposalWrapper(\n    entityUrn=tag_urn,\n    aspect=tag_properties_aspect,\n)\n\n# Create rest emitter\nrest_emitter = DatahubRestEmitter(gms_server="http://localhost:8080")\nrest_emitter.emit(event)\nlog.info(f"Created tag {tag_urn}")\n\n')))),(0,n.yg)("h3",{id:"expected-outcome-of-creating-tags"},"Expected Outcome of Creating Tags"),(0,n.yg)("p",null,"You can now see the new tag ",(0,n.yg)("inlineCode",{parentName:"p"},"Deprecated")," has been created."),(0,n.yg)("p",{align:"center"},(0,n.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/apis/tutorials/tag-created.png"})),(0,n.yg)("p",null,"We can also verify this operation by programmatically searching ",(0,n.yg)("inlineCode",{parentName:"p"},"Deprecated")," tag after running this code using the ",(0,n.yg)("inlineCode",{parentName:"p"},"datahub")," cli."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'datahub get --urn "urn:li:tag:deprecated" --aspect tagProperties\n\n{\n  "tagProperties": {\n    "description": "Having this tag means this column or table is deprecated.",\n    "name": "Deprecated"\n  }\n}\n')),(0,n.yg)("h2",{id:"read-tags"},"Read Tags"),(0,n.yg)(r.A,{mdxType:"Tabs"},(0,n.yg)(s.A,{value:"graphql",label:"GraphQL",default:!0,mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'query {\n  dataset(urn: "urn:li:dataset:(urn:li:dataPlatform:hive,SampleHiveDataset,PROD)") {\n    tags {\n      tags {\n        tag {\n          name\n          urn\n            properties {\n              description\n              colorHex\n            }\n        }\n      }\n    }\n  }\n}\n')),(0,n.yg)("p",null,"If you see the following response, the operation was successful:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'{\n  "data": {\n    "dataset": {\n      "tags": {\n        "tags": [\n          {\n            "tag": {\n              "name": "Legacy",\n              "urn": "urn:li:tag:Legacy",\n              "properties": {\n                "description": "Indicates the dataset is no longer supported",\n                "colorHex": null,\n                "name": "Legacy"\n              }\n            }\n          }\n        ]\n      }\n    }\n  },\n  "extensions": {}\n}\n'))),(0,n.yg)(s.A,{value:"curl",label:"Curl",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},"curl --location --request POST 'http://localhost:8080/api/graphql' \\\n--header 'Authorization: Bearer <my-access-token>' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{ \"query\": \"{dataset(urn: \\\"urn:li:dataset:(urn:li:dataPlatform:hive,SampleHiveDataset,PROD)\\\") {tags {tags {tag {name urn properties { description colorHex } } } } } }\", \"variables\":{}}'\n")),(0,n.yg)("p",null,"Expected Response:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "dataset": {\n      "tags": {\n        "tags": [\n          {\n            "tag": {\n              "name": "Legacy",\n              "urn": "urn:li:tag:Legacy",\n              "properties": {\n                "description": "Indicates the dataset is no longer supported",\n                "colorHex": null\n              }\n            }\n          }\n        ]\n      }\n    }\n  },\n  "extensions": {}\n}\n'))),(0,n.yg)(s.A,{value:"python",label:"Python",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'# Inlined from /metadata-ingestion/examples/library/dataset_query_tags.py\nfrom datahub.emitter.mce_builder import make_dataset_urn\n\n# read-modify-write requires access to the DataHubGraph (RestEmitter is not enough)\nfrom datahub.ingestion.graph.client import DatahubClientConfig, DataHubGraph\n\n# Imports for metadata model classes\nfrom datahub.metadata.schema_classes import GlobalTagsClass\n\ndataset_urn = make_dataset_urn(platform="hive", name="SampleHiveDataset", env="PROD")\n\ngms_endpoint = "http://localhost:8080"\ngraph = DataHubGraph(DatahubClientConfig(server=gms_endpoint))\n\n# Query multiple aspects from entity\nresult = graph.get_aspects_for_entity(\n    entity_urn=dataset_urn,\n    aspects=["globalTags"],\n    aspect_types=[GlobalTagsClass],\n)\n\nprint(result)\n\n')))),(0,n.yg)("h2",{id:"add-tags"},"Add Tags"),(0,n.yg)("h3",{id:"add-tags-to-a-dataset"},"Add Tags to a dataset"),(0,n.yg)("p",null,"The following code shows you how can add tags to a dataset.\nIn the following code, we add a tag ",(0,n.yg)("inlineCode",{parentName:"p"},"Deprecated")," to a dataset named ",(0,n.yg)("inlineCode",{parentName:"p"},"fct_users_created"),"."),(0,n.yg)(r.A,{mdxType:"Tabs"},(0,n.yg)(s.A,{value:"graphql",label:"GraphQL",default:!0,mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'mutation addTags {\n    addTags(\n      input: {\n        tagUrns: ["urn:li:tag:deprecated"],\n        resourceUrn: "urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)",\n      }\n    )\n}\n')),(0,n.yg)("p",null,"If you see the following response, the operation was successful:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'{\n  "data": {\n    "addTags": true\n  },\n  "extensions": {}\n}\n'))),(0,n.yg)(s.A,{value:"curl",label:"Curl",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'http://localhost:8080/api/graphql\' \\\n--header \'Authorization: Bearer <my-access-token>\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{ "query": "mutation addTags { addTags(input: { tagUrns: [\\"urn:li:tag:deprecated\\"], resourceUrn: \\"urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)\\" }) }", "variables":{}}\'\n')),(0,n.yg)("p",null,"Expected Response:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'{ "data": { "addTags": true }, "extensions": {} }\n'))),(0,n.yg)(s.A,{value:"python",label:"Python",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'# Inlined from /metadata-ingestion/examples/library/dataset_add_tag.py\nimport logging\nfrom typing import Optional\n\nfrom datahub.emitter.mce_builder import make_dataset_urn, make_tag_urn\nfrom datahub.emitter.mcp import MetadataChangeProposalWrapper\n\n# read-modify-write requires access to the DataHubGraph (RestEmitter is not enough)\nfrom datahub.ingestion.graph.client import DatahubClientConfig, DataHubGraph\n\n# Imports for metadata model classes\nfrom datahub.metadata.schema_classes import GlobalTagsClass, TagAssociationClass\n\nlog = logging.getLogger(__name__)\nlogging.basicConfig(level=logging.INFO)\n\n\n# First we get the current tags\ngms_endpoint = "http://localhost:8080"\ngraph = DataHubGraph(DatahubClientConfig(server=gms_endpoint))\n\ndataset_urn = make_dataset_urn(platform="hive", name="realestate_db.sales", env="PROD")\n\ncurrent_tags: Optional[GlobalTagsClass] = graph.get_aspect(\n    entity_urn=dataset_urn,\n    aspect_type=GlobalTagsClass,\n)\n\ntag_to_add = make_tag_urn("purchase")\ntag_association_to_add = TagAssociationClass(tag=tag_to_add)\n\nneed_write = False\nif current_tags:\n    if tag_to_add not in [x.tag for x in current_tags.tags]:\n        # tags exist, but this tag is not present in the current tags\n        current_tags.tags.append(TagAssociationClass(tag_to_add))\n        need_write = True\nelse:\n    # create a brand new tags aspect\n    current_tags = GlobalTagsClass(tags=[tag_association_to_add])\n    need_write = True\n\nif need_write:\n    event: MetadataChangeProposalWrapper = MetadataChangeProposalWrapper(\n        entityUrn=dataset_urn,\n        aspect=current_tags,\n    )\n    graph.emit(event)\n    log.info(f"Tag {tag_to_add} added to dataset {dataset_urn}")\n\nelse:\n    log.info(f"Tag {tag_to_add} already exists, omitting write")\n\n')))),(0,n.yg)("h3",{id:"add-tags-to-a-column-of-a-dataset"},"Add Tags to a Column of a dataset"),(0,n.yg)("p",null,"In the example below ",(0,n.yg)("inlineCode",{parentName:"p"},"subResource")," is ",(0,n.yg)("inlineCode",{parentName:"p"},"fieldPath")," in the schema."),(0,n.yg)(r.A,{mdxType:"Tabs"},(0,n.yg)(s.A,{value:"graphql",label:"GraphQL",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'mutation addTags {\n    addTags(\n      input: {\n        tagUrns: ["urn:li:tag:deprecated"],\n        resourceUrn: "urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)",\n        subResourceType:DATASET_FIELD,\n        subResource:"user_name"})\n}\n'))),(0,n.yg)(s.A,{value:"curl",label:"Curl",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'http://localhost:8080/api/graphql\' \\\n--header \'Authorization: Bearer <my-access-token>\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{ "query": "mutation addTags { addTags(input: { tagUrns: [\\"urn:li:tag:deprecated\\"], resourceUrn: \\"urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)\\", subResourceType: DATASET_FIELD, subResource: \\"user_name\\" }) }", "variables":{}}\'\n')),(0,n.yg)("p",null,"Expected Response:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'{ "data": { "addTags": true }, "extensions": {} }\n'))),(0,n.yg)(s.A,{value:"python",label:"Python",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'# Inlined from /metadata-ingestion/examples/library/dataset_add_column_tag.py\nimport logging\nimport time\n\nfrom datahub.emitter.mce_builder import make_dataset_urn, make_tag_urn\nfrom datahub.emitter.mcp import MetadataChangeProposalWrapper\n\n# read-modify-write requires access to the DataHubGraph (RestEmitter is not enough)\nfrom datahub.ingestion.graph.client import DatahubClientConfig, DataHubGraph\n\n# Imports for metadata model classes\nfrom datahub.metadata.schema_classes import (\n    AuditStampClass,\n    EditableSchemaFieldInfoClass,\n    EditableSchemaMetadataClass,\n    GlobalTagsClass,\n    TagAssociationClass,\n)\nfrom datahub.utilities.urns.field_paths import get_simple_field_path_from_v2_field_path\n\nlog = logging.getLogger(__name__)\nlogging.basicConfig(level=logging.INFO)\n\n\n# Inputs -> the column, dataset and the tag to set\ncolumn = "user_name"\ndataset_urn = make_dataset_urn(platform="hive", name="fct_users_created", env="PROD")\ntag_to_add = make_tag_urn("deprecated")\n\n\n# First we get the current editable schema metadata\ngms_endpoint = "http://localhost:8080"\ngraph = DataHubGraph(DatahubClientConfig(server=gms_endpoint))\n\n\ncurrent_editable_schema_metadata = graph.get_aspect(\n    entity_urn=dataset_urn,\n    aspect_type=EditableSchemaMetadataClass,\n)\n\n\n# Some pre-built objects to help all the conditional pathways\ntag_association_to_add = TagAssociationClass(tag=tag_to_add)\ntags_aspect_to_set = GlobalTagsClass(tags=[tag_association_to_add])\nfield_info_to_set = EditableSchemaFieldInfoClass(\n    fieldPath=column, globalTags=tags_aspect_to_set\n)\n\n\nneed_write = False\nfield_match = False\nif current_editable_schema_metadata:\n    for fieldInfo in current_editable_schema_metadata.editableSchemaFieldInfo:\n        if get_simple_field_path_from_v2_field_path(fieldInfo.fieldPath) == column:\n            # we have some editable schema metadata for this field\n            field_match = True\n            if fieldInfo.globalTags:\n                if tag_to_add not in [x.tag for x in fieldInfo.globalTags.tags]:\n                    # this tag is not present\n                    fieldInfo.globalTags.tags.append(tag_association_to_add)\n                    need_write = True\n            else:\n                fieldInfo.globalTags = tags_aspect_to_set\n                need_write = True\n\n    if not field_match:\n        # this field isn\'t present in the editable schema metadata aspect, add it\n        field_info = field_info_to_set\n        current_editable_schema_metadata.editableSchemaFieldInfo.append(field_info)\n        need_write = True\n\nelse:\n    # create a brand new editable schema metadata aspect\n    now = int(time.time() * 1000)  # milliseconds since epoch\n    current_timestamp = AuditStampClass(time=now, actor="urn:li:corpuser:ingestion")\n    current_editable_schema_metadata = EditableSchemaMetadataClass(\n        editableSchemaFieldInfo=[field_info_to_set],\n        created=current_timestamp,\n    )\n    need_write = True\n\nif need_write:\n    event: MetadataChangeProposalWrapper = MetadataChangeProposalWrapper(\n        entityUrn=dataset_urn,\n        aspect=current_editable_schema_metadata,\n    )\n    graph.emit(event)\n    log.info(f"Tag {tag_to_add} added to column {column} of dataset {dataset_urn}")\n\nelse:\n    log.info(f"Tag {tag_to_add} already attached to column {column}, omitting write")\n\n')))),(0,n.yg)("h3",{id:"expected-outcome-of-adding-tags"},"Expected Outcome of Adding Tags"),(0,n.yg)("p",null,"You can now see ",(0,n.yg)("inlineCode",{parentName:"p"},"Deprecated")," tag has been added to ",(0,n.yg)("inlineCode",{parentName:"p"},"user_name")," column."),(0,n.yg)("p",{align:"center"},(0,n.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/apis/tutorials/tag-added.png"})),(0,n.yg)("p",null,"We can also verify this operation programmatically by checking the ",(0,n.yg)("inlineCode",{parentName:"p"},"globalTags")," aspect using the ",(0,n.yg)("inlineCode",{parentName:"p"},"datahub")," cli."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'datahub get --urn "urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)" --aspect globalTags\n\n')),(0,n.yg)("h2",{id:"remove-tags"},"Remove Tags"),(0,n.yg)("p",null,"The following code remove a tag from a dataset.\nAfter running this code, ",(0,n.yg)("inlineCode",{parentName:"p"},"Deprecated")," tag will be removed from a ",(0,n.yg)("inlineCode",{parentName:"p"},"user_name")," column."),(0,n.yg)(r.A,{mdxType:"Tabs"},(0,n.yg)(s.A,{value:"graphql",label:"GraphQL",default:!0,mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'mutation removeTag {\n    removeTag(\n      input: {\n        tagUrn: "urn:li:tag:deprecated",\n        resourceUrn: "urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)",\n        subResourceType:DATASET_FIELD,\n        subResource:"user_name"})\n}\n'))),(0,n.yg)(s.A,{value:"curl",label:"Curl",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'http://localhost:8080/api/graphql\' \\\n--header \'Authorization: Bearer <my-access-token>\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{ "query": "mutation removeTag { removeTag(input: { tagUrn: \\"urn:li:tag:deprecated\\", resourceUrn: \\"urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)\\" }) }", "variables":{}}\'\n'))),(0,n.yg)(s.A,{value:"python",label:"Python",mdxType:"TabItem"},(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'# Inlined from /metadata-ingestion/examples/library/dataset_remove_tag_execute_graphql.py\n# read-modify-write requires access to the DataHubGraph (RestEmitter is not enough)\nfrom datahub.ingestion.graph.client import DatahubClientConfig, DataHubGraph\n\ngms_endpoint = "http://localhost:8080"\ngraph = DataHubGraph(DatahubClientConfig(server=gms_endpoint))\n\n# Query multiple aspects from entity\nquery = """\nmutation removeTag {\n    removeTag(\n      input: {\n        tagUrn: "urn:li:tag:deprecated",\n        resourceUrn: "urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)",\n        subResourceType:DATASET_FIELD,\n        subResource:"user_name"})\n}\n"""\nresult = graph.execute_graphql(query=query)\n\nprint(result)\n\n')))),(0,n.yg)("h3",{id:"expected-outcome-of-removing-tags"},"Expected Outcome of Removing Tags"),(0,n.yg)("p",null,"You can now see ",(0,n.yg)("inlineCode",{parentName:"p"},"Deprecated")," tag has been removed to ",(0,n.yg)("inlineCode",{parentName:"p"},"user_name")," column."),(0,n.yg)("p",{align:"center"},(0,n.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/apis/tutorials/tag-removed.png"})),(0,n.yg)("p",null,"We can also verify this operation programmatically by checking the ",(0,n.yg)("inlineCode",{parentName:"p"},"gloablTags")," aspect using the ",(0,n.yg)("inlineCode",{parentName:"p"},"datahub")," cli."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'datahub get --urn "urn:li:dataset:(urn:li:dataPlatform:hive,fct_users_created,PROD)" --aspect globalTags\n\n{\n  "globalTags": {\n    "tags": []\n  }\n}\n')))}y.isMDXComponent=!0}}]);